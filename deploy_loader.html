<!DOCTYPE html>
<html lang="en" class="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Setting up...</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: { sans: ['Plus Jakarta Sans', 'sans-serif'], mono: ['JetBrains Mono', 'monospace'] },
          colors: { brand: { 500: '#10b981', 600: '#059669' } }
        }
      }
    }
  </script>

  <style>
    body {
      background-color: #f8fafc;
      margin: 0; height: 100vh; overflow: hidden;
      display: flex; align-items: center; justify-content: center;
    }
    .dark body { background-color: #020408; }

    /* BACKGROUND GRADIENT BLUR */
    .bg-glow {
      position: absolute; width: 600px; height: 600px;
      background: radial-gradient(circle, rgba(16,185,129,0.15) 0%, rgba(0,0,0,0) 70%);
      top: 50%; left: 50%; transform: translate(-50%, -50%);
      z-index: 0; pointer-events: none;
    }

    /* MORPH CARD */
    #morph-container {
      width: 90%; max-width: 420px; /* Mobile Optimized */
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(24px);
      border: 1px solid rgba(255,255,255,0.8);
      border-radius: 32px;
      box-shadow: 0 30px 60px -10px rgba(0, 0, 0, 0.12);
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 48px 32px;
      z-index: 50;
      transform-origin: center center;
    }
    .dark #morph-container {
      background: rgba(15, 23, 42, 0.8);
      border-color: rgba(255,255,255,0.08);
      box-shadow: 0 30px 60px -10px rgba(0, 0, 0, 0.5);
    }

    /* AVATAR */
    .avatar-container {
      position: relative; margin-bottom: 32px;
    }
    .avatar-circle {
      width: 88px; height: 88px; border-radius: 28px;
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
      display: flex; align-items: center; justify-content: center;
      font-size: 36px;
      box-shadow: 0 15px 35px rgba(16, 185, 129, 0.4);
      position: relative; z-index: 20;
    }
    /* Avatar Pulse Ring */
    .avatar-ring {
      position: absolute; inset: -4px; border-radius: 32px;
      border: 2px solid #10b981; opacity: 0;
    }

    /* TEXT */
    .status-text {
      font-size: 20px; font-weight: 800; color: #0f172a;
      margin-bottom: 8px; text-align: center; letter-spacing: -0.02em;
    }
    .dark .status-text { color: white; }

    .sub-text {
      font-size: 14px; color: #64748b; margin-bottom: 40px;
      font-weight: 500; text-align: center;
    }

    /* LOADING BAR AREA */
    .loader-wrapper { width: 100%; position: relative; }
    
    .brand-label {
      display: flex; justify-content: space-between; align-items: flex-end;
      margin-bottom: 10px;
    }
    .brand-name {
      font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em;
      color: #0f172a; display: flex; align-items: center; gap: 6px;
    }
    .dark .brand-name { color: white; }
    
    .loading-line-track {
      width: 100%; height: 6px; background: #e2e8f0;
      border-radius: 99px; overflow: hidden; position: relative;
    }
    .dark .loading-line-track { background: #334155; }
    
    .loading-line-fill {
      width: 0%; height: 100%; background: #10b981;
      border-radius: 99px; position: relative;
    }
    
    /* Shimmer effect on bar */
    .loading-line-fill::after {
      content: ''; position: absolute; top: 0; left: 0; bottom: 0; width: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      transform: translateX(-100%);
      animation: shimmer 1.5s infinite;
    }
    @keyframes shimmer { 100% { transform: translateX(100%); } }

  </style>
</head>
<body>

  <div class="bg-glow"></div>

  <!-- MAIN MORPH CARD -->
  <div id="morph-container">
    
    <!-- 1. Avatar -->
    <div class="avatar-container" id="avatar-wrap">
      <div class="avatar-circle" id="avatar">
        <i class="fa-solid fa-user"></i>
      </div>
      <div class="avatar-ring" id="pulse-ring"></div>
    </div>

    <!-- 2. Text Content -->
    <div id="text-wrapper" class="flex flex-col items-center w-full">
      <div class="status-text" id="status">Secure Handshake</div>
      <div class="sub-text" id="details">Verifying credentials...</div>

      <!-- 3. Elegant Loader with Brand -->
      <div class="loader-wrapper">
        <div class="brand-label">
          <span class="brand-name">
            <i class="fa-solid fa-link text-brand-500"></i> shortmylink.in
          </span>
          <span class="text-xs font-mono text-neutral-400" id="percent">0%</span>
        </div>
        <div class="loading-line-track">
          <div class="loading-line-fill" id="progress-bar"></div>
        </div>
      </div>
    </div>

  </div>

  <script>
    // --- SESSION LOGIC ---
    function createAccountSession() {
      const date = new Date();
      date.setTime(date.getTime() + (24 * 60 * 60 * 1000));
      document.cookie = "shortmylink_auth=true; expires=" + date.toUTCString() + "; path=/";
      localStorage.setItem('user_role', 'NEW_PUBLISHER');
    }

    // --- ANIMATION ---
    const tl = gsap.timeline();
    
    const container = document.getElementById('morph-container');
    const avatarWrap = document.getElementById('avatar-wrap');
    const avatar = document.getElementById('avatar');
    const pulseRing = document.getElementById('pulse-ring');
    const statusText = document.getElementById('status');
    const detailsText = document.getElementById('details');
    const progressBar = document.getElementById('progress-bar');
    const percentText = document.getElementById('percent');
    const textWrapper = document.getElementById('text-wrapper');

    // 0. Subtle Pulse on Avatar
    gsap.to(pulseRing, { scale: 1.4, opacity: 0, duration: 1.5, repeat: -1 });

    // 1. Loading Sequence
    tl.to(progressBar, {
      width: "45%", duration: 1.2, ease: "power2.out",
      onUpdate: function() { percentText.innerText = Math.round(this.progress() * 45) + "%" },
      onStart: () => { detailsText.innerText = "Generating Keys..."; }
    });
    
    tl.to(progressBar, {
      width: "85%", duration: 1.0, ease: "power2.inOut",
      onUpdate: function() { percentText.innerText = Math.round(45 + (this.progress() * 40)) + "%" },
      onStart: () => { 
        statusText.innerText = "Finalizing";
        detailsText.innerText = "Allocating Dashboard..."; 
      }
    });

    tl.to(progressBar, {
      width: "100%", duration: 0.4, ease: "power1.in",
      onUpdate: function() { percentText.innerText = "100%" },
      onStart: () => { detailsText.innerText = "Ready."; }
    });

    // 2. THE TRANSITION (Responsive)
    tl.add(() => {
      createAccountSession();

      const isMobile = window.innerWidth < 768;

      // A. Fade out text & bar
      gsap.to(textWrapper, { opacity: 0, y: 20, duration: 0.3 });

      // B. Expand Card (White Flash -> Transparent)
      gsap.to(container, {
        scale: isMobile ? 1.1 : 5, // Smaller scale on mobile to prevent glitches
        opacity: 0,
        duration: 0.6,
        ease: "power2.in"
      });

      if (!isMobile) {
        // DESKTOP: Avatar flies to Header position
        const targetX = (window.innerWidth / 2) - 60; 
        const targetY = -(window.innerHeight / 2) + 40; 

        gsap.to(avatarWrap, {
          x: targetX,
          y: targetY,
          scale: 0.4, 
          duration: 0.6,
          ease: "power2.inOut"
        });
      } else {
        // MOBILE: Simple scale up fade out (Cleaner on phones)
        gsap.to(avatarWrap, {
          scale: 3,
          opacity: 0,
          duration: 0.5,
          ease: "power2.in"
        });
      }

      // C. REDIRECT
      setTimeout(() => {
        window.location.href = "dashboard.html";
      }, 600);

    });

  </script>
</body>
</html>