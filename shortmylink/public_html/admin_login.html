<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Access | ShortMyLink.in</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #ffffff; overflow-x: hidden; }

        /* --- INTERACTIVE ILLUSTRATION --- */
        .illustration-wrapper { position: relative; width: 300px; height: 300px; transition: transform 0.1s; }
        
        /* Shared Styles */
        .char { position: absolute; bottom: 0; transition: all 0.3s ease-out; }
        .eyes-container { position: absolute; display: flex; transition: all 0.3s; }
        .pupil { transition: transform 0.1s; }

        /* 1. Purple Character (Tall) */
        .char-purple {
            left: 40px; width: 90px; height: 190px;
            background-color: #7c3aed;
            border-top-left-radius: 45px; border-top-right-radius: 10px;
            z-index: 2; transform-origin: bottom center;
        }
        .face-purple { top: 40px; left: 20px; gap: 12px; }
        .eye-purple { width: 10px; height: 10px; background: #000; border-radius: 50%; }
        .mouth-purple { width: 15px; height: 8px; border-bottom: 2px solid #000; border-radius: 50%; margin: 10px 0 0 10px; }

        /* 2. Black Character (The Watcher) */
        .char-black {
            left: 100px; width: 100px; height: 140px;
            background-color: #000;
            border-top-left-radius: 50px; border-top-right-radius: 50px;
            z-index: 3; transform-origin: bottom center;
        }
        .face-black { top: 40px; left: 24px; gap: 6px; }
        .eye-white { 
            width: 22px; height: 22px; background: #fff; border-radius: 50%; 
            position: relative; overflow: hidden; display: flex; align-items: center; justify-content: center;
        }
        .pupil-black { width: 8px; height: 8px; background: #000; border-radius: 50%; position: absolute; }

        /* 3. Orange Blob (Short) */
        .char-orange {
            left: 0; width: 120px; height: 90px;
            background-color: #f97316;
            border-top-left-radius: 60px; border-top-right-radius: 60px;
            z-index: 4;
        }
        .face-orange { top: 35px; left: 40px; gap: 15px; }
        .eye-orange { width: 7px; height: 7px; background: #000; border-radius: 50%; }
        .mouth-orange { width: 10px; height: 10px; border: 2px solid #000; border-color: transparent transparent #000 #000; border-radius: 50%; transform: rotate(-45deg); margin-top: 5px; }

        /* 4. Yellow Character (Right) */
        .char-yellow {
            right: 40px; width: 70px; height: 110px;
            background-color: #fbbf24;
            border-top-left-radius: 35px; border-top-right-radius: 35px;
            z-index: 1;
        }
        .face-yellow { top: 30px; left: 20px; gap: 8px; }
        .eye-yellow { width: 6px; height: 6px; background: #000; border-radius: 50%; }
        .mouth-line { width: 12px; height: 2px; background: #000; margin: 8px 0 0 4px; }

        /* --- ANIMATION CLASSES --- */
        .is-hiding .eye-white { height: 4px; border-radius: 2px; background: #555; margin-top: 10px; }
        .is-hiding .pupil-black { opacity: 0; }
        .is-hiding .eye-purple, .is-hiding .eye-orange, .is-hiding .eye-yellow { transform: scaleY(0.2); }
        .is-hiding .char-black { transform: translateY(5px); }

        .shake-anim { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        .input-underline { border: none; border-bottom: 2px solid #e5e7eb; padding: 12px 0; background: transparent; transition: 0.3s; }
        .input-underline:focus { outline: none; border-color: #000; }
        .btn-hover { transition: transform 0.2s; } .btn-hover:active { transform: scale(0.98); }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center bg-gray-50 p-4 md:p-8">

    <div class="w-full max-w-5xl bg-white rounded-[40px] shadow-2xl overflow-hidden flex flex-col md:flex-row min-h-[700px]">
        
        <!-- LEFT: Interactive Illustration Area -->
        <div class="w-full md:w-1/2 bg-[#f3f4f6] relative flex items-center justify-center p-8 overflow-hidden" id="scene-area">
            
            <!-- Animated Stars -->
            <div class="absolute top-20 right-20 text-2xl animate-pulse"><i class="fa-solid fa-star-of-life"></i></div>
            <div class="absolute bottom-32 left-10 text-xl animate-bounce" style="animation-duration: 3s;"><i class="fa-solid fa-star-of-life"></i></div>

            <!-- The Characters -->
            <div class="illustration-wrapper" id="illustration">
                <div class="char char-yellow">
                    <div class="eyes-container face-yellow"><div class="eye-yellow"></div><div class="eye-yellow"></div></div>
                    <div class="mouth-line"></div>
                </div>
                <div class="char char-purple">
                    <div class="eyes-container face-purple"><div class="eye-purple"></div><div class="eye-purple"></div></div>
                    <div class="mouth-purple"></div>
                </div>
                <div class="char char-black">
                    <div class="eyes-container face-black">
                        <div class="eye-white"><div class="pupil-black target-pupil"></div></div>
                        <div class="eye-white"><div class="pupil-black target-pupil"></div></div>
                    </div>
                </div>
                <div class="char char-orange">
                    <div class="eyes-container face-orange"><div class="eye-orange"></div><div class="eye-orange"></div></div>
                    <div class="mouth-orange" style="position:absolute; top:45px; left:55px;"></div>
                </div>
            </div>
        </div>

        <!-- RIGHT: Admin Login Form -->
        <div class="w-full md:w-1/2 bg-white p-10 md:p-16 flex flex-col justify-center relative">
            
            <div class="max-w-md mx-auto w-full">
                <div class="flex items-center gap-2 mb-8">
                    <div class="w-8 h-8 bg-black rounded-lg flex items-center justify-center text-white"><i class="fa-solid fa-shield-halved text-xs"></i></div>
                    <span class="font-bold text-lg">ShortMyLink Admin</span>
                </div>

                <h1 class="text-4xl font-extrabold text-gray-900 mb-2">Root Access</h1>
                <p class="text-gray-500 mb-10">Authenticate to continue</p>

                <form id="login-form" onsubmit="handleAdminLogin(event)" class="space-y-6">
                    <div class="space-y-1">
                        <label class="text-xs font-bold text-gray-900 uppercase tracking-wide">Admin ID</label>
                        <input type="text" id="admin-id" class="input-underline w-full font-medium" placeholder="OMDHAGE">
                    </div>

                    <div class="space-y-1 relative">
                        <label class="text-xs font-bold text-gray-900 uppercase tracking-wide">Secure Key</label>
                        <input type="password" id="admin-pass" class="input-underline w-full font-medium" placeholder="••••••••••••">
                        <button type="button" onclick="togglePass()" class="absolute right-0 bottom-3 text-gray-400 hover:text-black">
                            <i class="fa-regular fa-eye" id="eye-icon"></i>
                        </button>
                    </div>

                    <div class="flex items-center justify-between pt-2">
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" class="w-4 h-4 rounded border-gray-300 text-black focus:ring-black">
                            <span class="text-sm text-gray-500 font-medium">Keep Session Active</span>
                        </label>
                    </div>

                    <button type="submit" id="submit-btn" class="w-full bg-black text-white font-bold py-4 rounded-xl shadow-lg shadow-gray-200 btn-hover mt-4">
                        Initialize Session
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // --- 1. EYE TRACKING LOGIC ---
        const pupils = document.querySelectorAll('.target-pupil');
        const charsContainer = document.getElementById('illustration');

        document.addEventListener('mousemove', (e) => {
            if(document.getElementById('admin-pass') === document.activeElement) return;

            const x = e.clientX;
            const y = e.clientY;

            pupils.forEach(pupil => {
                const rect = pupil.parentElement.getBoundingClientRect();
                const eyeCenterX = rect.left + rect.width / 2;
                const eyeCenterY = rect.top + rect.height / 2;
                const angle = Math.atan2(y - eyeCenterY, x - eyeCenterX);
                const distance = Math.min(3, Math.hypot(x - eyeCenterX, y - eyeCenterY) / 10);
                const pupilX = Math.cos(angle) * distance;
                const pupilY = Math.sin(angle) * distance;
                pupil.style.transform = `translate(${pupilX}px, ${pupilY}px)`;
            });

            const moveX = (window.innerWidth / 2 - x) / 50;
            const moveY = (window.innerHeight / 2 - y) / 50;
            charsContainer.style.transform = `translate(${moveX}px, ${moveY}px)`;
        });

        // --- 2. PASSWORD PEEK/HIDE LOGIC ---
        const passInput = document.getElementById('admin-pass');
        const illustration = document.getElementById('illustration');

        passInput.addEventListener('focus', () => illustration.classList.add('is-hiding'));
        passInput.addEventListener('blur', () => {
            illustration.classList.remove('is-hiding');
            pupils.forEach(p => p.style.transform = 'translate(0,0)');
        });

        // --- 3. ADMIN LOGIN LOGIC (API CONNECTED) ---
        async function handleAdminLogin(e) {
            e.preventDefault();
            const user = document.getElementById('admin-id').value;
            const pass = document.getElementById('admin-pass').value;
            const btn = document.getElementById('submit-btn');

            // Visual Check
            if(!user || !pass) {
                triggerShake();
                return;
            }

            // Loading
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i> Verifying...';
            btn.disabled = true;

            try {
                // Call the Admin API
                const res = await fetch('api/admin.php', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ action: 'login', username: user, password: pass })
                });
                const data = await res.json();

                if (data.status === 'success') {
                    // Success
                    localStorage.setItem('admin_user', data.username);
                    localStorage.setItem('user_role', 'ROOT_ADMIN'); // Set for session logic
                    window.location.href = 'admin_dashboard.html';
                } else {
                    // Failed
                    triggerShake();
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                    // Optional: show specific message if needed, but visual shake is good for security
                    console.log(data.message);
                }
            } catch (err) {
                console.error(err);
                triggerShake();
                alert("System Error: Check Connection");
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        function triggerShake() {
            const form = document.getElementById('login-form');
            const ill = document.getElementById('illustration');
            form.classList.add('shake-anim');
            ill.classList.add('shake-anim');
            setTimeout(() => {
                form.classList.remove('shake-anim');
                ill.classList.remove('shake-anim');
            }, 500);
        }

        function togglePass() {
            const input = document.getElementById('admin-pass');
            const icon = document.getElementById('eye-icon');
            if(input.type === 'password') {
                input.type = 'text';
                icon.classList.replace('fa-eye', 'fa-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.replace('fa-eye-slash', 'fa-eye');
            }
        }
    </script>
</body>
</html>