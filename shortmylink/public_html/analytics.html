<!DOCTYPE html>
<html lang="en" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics | ShortMyLink.in</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* --- SHARED STYLES (Matching Dashboard) --- */
        html.lenis, html.lenis body { height: auto; }
        .lenis.lenis-smooth { scroll-behavior: auto !important; }
        .lenis.lenis-stopped { overflow: hidden; }
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #f8fafc;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .dark body { background-color: #020408; color: #e5e5e5; }

        ::view-transition-old(root), ::view-transition-new(root) { animation: none; mix-blend-mode: normal; }

        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        .tech-grid {
            background-size: 40px 40px;
            background-image: linear-gradient(to right, rgba(0,0,0,0.03) 1px, transparent 1px),
                              linear-gradient(to bottom, rgba(0,0,0,0.03) 1px, transparent 1px);
        }
        .dark .tech-grid {
            background-image: linear-gradient(to right, rgba(255,255,255,0.03) 1px, transparent 1px),
                              linear-gradient(to bottom, rgba(255,255,255,0.03) 1px, transparent 1px);
        }

        .sidebar-glass {
            background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(20px); border-right: 1px solid rgba(0,0,0,0.05);
        }
        .dark .sidebar-glass {
            background: rgba(10, 10, 10, 0.6); border-right: 1px solid rgba(255,255,255,0.05);
        }

        /* ANALYTICS SPECIFIC CARDS */
        .stat-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(0,0,0,0.05);
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.02);
            transition: all 0.3s ease;
        }
        .dark .stat-card {
            background: rgba(20, 20, 20, 0.6);
            border: 1px solid rgba(255,255,255,0.05);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }
        .stat-card:hover { transform: translateY(-2px); box-shadow: 0 10px 20px -5px rgba(0,0,0,0.05); }

        /* NAV & CONTROLS */
        .nav-item.active { background: rgba(16, 185, 129, 0.1); color: #10b981; }
        
        .control-btn {
            background: white; border: 1px solid #e2e8f0; color: #64748b;
            transition: all 0.2s;
        }
        .dark .control-btn { background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.1); color: #94a3b8; }
        .control-btn:hover { border-color: #10b981; color: #10b981; }

        /* WORLD MAP SVG STYLING */
        .map-container svg { fill: #e2e8f0; width: 100%; height: 100%; transition: fill 0.3s; }
        .dark .map-container svg { fill: #1e293b; }
        .map-container .hotspot { fill: #10b981; animation: pulse 2s infinite; transform-box: fill-box; transform-origin: center; }
        
        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.5); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        /* CUSTOM SCROLLBAR */
        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .dark .custom-scroll::-webkit-scrollbar-thumb { background: #334155; }
    </style>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        brand: { 50: '#ecfdf5', 100: '#d1fae5', 200: '#a7f3d0', 400: '#34d399', 500: '#10b981', 600: '#059669', 700: '#047857', 800: '#065f46', 900: '#064e3b' }
                    }
                }
            }
        }
    </script>
</head>
<body class="h-screen overflow-hidden flex text-neutral-800 dark:text-neutral-200 transition-colors duration-300">

    <!-- SIDEBAR (Matching Dashboard) -->
    <aside class="sidebar-glass w-20 lg:w-64 h-full flex flex-col fixed lg:relative z-30 transition-all duration-300 hidden md:flex">
        <div class="h-20 flex items-center justify-center lg:justify-start lg:px-8 border-b border-neutral-200/50 dark:border-white/5">
            <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-brand-800 to-brand-600 flex items-center justify-center text-white shadow-lg shadow-brand-900/20 shrink-0">
                <i class="fa-solid fa-link text-sm"></i>
            </div>
            <span class="font-bold text-xl ml-3 hidden lg:block tracking-tight text-neutral-900 dark:text-white">shortmylink</span>
        </div>
        <div class="flex-1 overflow-y-auto py-6 space-y-2 px-3">
            <a href="dashboard.html" class="nav-item flex items-center gap-4 px-4 py-3 rounded-xl text-sm font-medium text-neutral-600 dark:text-neutral-400 hover:text-brand-600 dark:hover:text-brand-400">
                <i class="fa-solid fa-grid-2 w-5 text-center"></i> <span class="hidden lg:block">Dashboard</span>
            </a>
            <!-- Active State on Analytics -->
            <a href="#" class="nav-item active flex items-center gap-4 px-4 py-3 rounded-xl text-sm font-medium text-brand-600 dark:text-brand-400 bg-brand-50 dark:bg-brand-900/10">
                <i class="fa-solid fa-chart-pie w-5 text-center"></i> <span class="hidden lg:block">Analytics</span>
            </a>
            <a href="#" class="nav-item flex items-center gap-4 px-4 py-3 rounded-xl text-sm font-medium text-neutral-600 dark:text-neutral-400 hover:text-brand-600 dark:hover:text-brand-400">
                <i class="fa-solid fa-link w-5 text-center"></i> <span class="hidden lg:block">Links</span>
            </a>
            <a href="#" class="nav-item flex items-center gap-4 px-4 py-3 rounded-xl text-sm font-medium text-neutral-600 dark:text-neutral-400 hover:text-brand-600 dark:hover:text-brand-400">
                <i class="fa-solid fa-wallet w-5 text-center"></i> <span class="hidden lg:block">Payouts</span>
            </a>
        </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="flex-1 flex flex-col h-full overflow-hidden relative bg-neutral-50 dark:bg-[#020408]">
        <div class="absolute inset-0 tech-grid opacity-100 pointer-events-none"></div>

        <!-- Header -->
        <header class="h-20 px-6 lg:px-10 flex items-center justify-between border-b border-neutral-200/50 dark:border-white/5 bg-white/50 dark:bg-black/20 backdrop-blur-md z-20">
            <div class="flex items-center gap-4">
                <button class="md:hidden text-neutral-500 dark:text-white"><i class="fa-solid fa-bars text-xl"></i></button>
                <h1 class="text-lg font-bold text-neutral-800 dark:text-white flex items-center gap-2">
                    Data Overview
                </h1>
            </div>
            <div class="flex items-center gap-4">
                <button class="magnetic-btn hidden sm:flex items-center gap-2 px-4 py-2 bg-brand-600 hover:bg-brand-700 text-white rounded-lg text-xs font-bold shadow-lg shadow-brand-500/20 transition-all hover:-translate-y-0.5">
                    <i class="fa-solid fa-file-csv"></i> Export Data
                </button>
                <button id="theme-toggle" class="w-9 h-9 rounded-full bg-neutral-100 dark:bg-white/10 flex items-center justify-center text-neutral-500 dark:text-neutral-400 hover:text-brand-600 transition-colors border border-transparent dark:border-white/10">
                    <i class="fa-solid fa-moon dark:hidden"></i> <i class="fa-solid fa-sun hidden dark:block"></i>
                </button>
            </div>
        </header>

        <!-- Content Scroll Area -->
        <div id="analytics-content" class="flex-1 overflow-y-auto relative z-10 p-6 lg:p-8 pb-20">
            
            <!-- Banner (Like the "Free Preview" in sample) -->
            <div class="mb-8 p-4 rounded-xl bg-brand-50 dark:bg-brand-900/10 border border-brand-200 dark:border-brand-500/20 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 gsap-fade-up">
                <div class="flex gap-3">
                    <div class="w-10 h-10 rounded-lg bg-brand-100 dark:bg-brand-500/20 flex items-center justify-center text-brand-600 dark:text-brand-400 shrink-0">
                        <i class="fa-solid fa-bolt"></i>
                    </div>
                    <div>
                        <h3 class="text-sm font-bold text-brand-800 dark:text-brand-300">Pro Analytics Unlocked</h3>
                        <p class="text-xs text-brand-600 dark:text-brand-400 mt-0.5">You are viewing real-time data streams. Data refreshes every 30 seconds.</p>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <span class="text-[10px] font-mono text-brand-600 dark:text-brand-400 uppercase bg-brand-100 dark:bg-brand-500/10 px-2 py-1 rounded animate-pulse">Live</span>
                </div>
            </div>

            <!-- Filters Bar -->
            <div class="flex flex-wrap items-center gap-3 mb-8 gsap-fade-up">
                <div class="flex items-center bg-white dark:bg-white/5 border border-neutral-200 dark:border-white/10 rounded-lg p-1">
                    <button class="px-3 py-1.5 rounded-md text-xs font-bold bg-neutral-100 dark:bg-white/10 text-neutral-900 dark:text-white shadow-sm">Overview</button>
                    <button class="px-3 py-1.5 rounded-md text-xs font-bold text-neutral-500 dark:text-neutral-400 hover:text-neutral-900 dark:hover:text-white transition-colors">Saved Reports</button>
                </div>
                
                <div class="h-6 w-px bg-neutral-200 dark:bg-white/10 mx-1"></div>

                <button class="control-btn px-3 py-1.5 rounded-lg text-xs font-bold flex items-center gap-2">
                    <i class="fa-regular fa-calendar"></i> Nov 17 - Nov 23, 2025
                </button>
                <button class="control-btn px-3 py-1.5 rounded-lg text-xs font-bold flex items-center gap-2">
                    <i class="fa-solid fa-filter"></i> Add Filters
                </button>
                <span class="text-xs text-neutral-400 ml-auto hidden sm:block font-mono">Showing data for all Links</span>
            </div>

            <!-- MAIN GRID -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                
                <!-- 1. ENGAGEMENTS OVER TIME (Line Chart) - Spans 2 cols -->
                <div class="lg:col-span-2 stat-card p-6 gsap-fade-up">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h3 class="text-sm font-bold text-neutral-900 dark:text-white">Total Engagements</h3>
                            <p class="text-xs text-neutral-500 mt-1">Clicks & QR Scans over time</p>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold font-mono text-neutral-900 dark:text-white">205</div>
                            <div class="text-[10px] font-bold text-brand-500">+12.5% vs last week</div>
                        </div>
                    </div>
                    <div class="h-[300px] w-full">
                        <canvas id="mainChart"></canvas>
                    </div>
                </div>

                <!-- 2. DEVICES (Donut Chart) - Spans 1 col -->
                <div class="stat-card p-6 gsap-fade-up">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-sm font-bold text-neutral-900 dark:text-white">By Device</h3>
                        <button class="text-neutral-400 hover:text-brand-500"><i class="fa-solid fa-download"></i></button>
                    </div>
                    <div class="h-[220px] w-full flex justify-center relative">
                        <canvas id="deviceChart"></canvas>
                        <!-- Center Text Overlay -->
                        <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                            <span class="text-3xl font-bold text-neutral-900 dark:text-white font-mono">381</span>
                            <span class="text-[10px] text-neutral-500 uppercase">Events</span>
                        </div>
                    </div>
                    <div class="mt-6 space-y-3">
                        <div class="flex justify-between text-xs">
                            <span class="flex items-center gap-2 text-neutral-600 dark:text-neutral-400"><span class="w-2 h-2 rounded-full bg-brand-500"></span> Desktop</span>
                            <span class="font-mono font-bold text-neutral-900 dark:text-white">146</span>
                        </div>
                        <div class="flex justify-between text-xs">
                            <span class="flex items-center gap-2 text-neutral-600 dark:text-neutral-400"><span class="w-2 h-2 rounded-full bg-blue-400"></span> Mobile</span>
                            <span class="font-mono font-bold text-neutral-900 dark:text-white">101</span>
                        </div>
                        <div class="flex justify-between text-xs">
                            <span class="flex items-center gap-2 text-neutral-600 dark:text-neutral-400"><span class="w-2 h-2 rounded-full bg-teal-400"></span> Tablet</span>
                            <span class="font-mono font-bold text-neutral-900 dark:text-white">70</span>
                        </div>
                    </div>
                </div>

                <!-- 3. LOCATIONS (Map + List) - Spans 2 cols -->
                <div class="lg:col-span-2 stat-card p-6 flex flex-col md:flex-row gap-6 gsap-fade-up">
                    <!-- Map Side -->
                    <div class="flex-1 relative min-h-[250px] map-container rounded-xl overflow-hidden border border-neutral-100 dark:border-white/5 bg-neutral-50 dark:bg-white/5">
                        <!-- Simple SVG World Map Placeholder -->
                        <svg viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg">
                            <path d="M150,100 Q200,50 250,100 T350,150 T450,100 T550,150 T650,100 T750,150 V300 H150 Z" opacity="0.2" /> 
                            <!-- Abstract Shapes representing continents -->
                            <path d="M50,120 Q100,80 180,130 T250,250 T150,300 T50,250 Z" class="continent" opacity="0.5" /> <!-- Americas -->
                            <path d="M350,80 Q450,50 550,100 T580,200 T450,250 T350,200 Z" class="continent" opacity="0.5" /> <!-- Eurasia/Africa -->
                            <path d="M600,200 Q650,180 700,220 T650,300 T600,250 Z" class="continent" opacity="0.5" /> <!-- Australia -->
                            
                            <!-- Pulsing Hotspots (CSS Animated) -->
                            <circle cx="150" cy="180" r="6" class="hotspot" /> <!-- USA -->
                            <circle cx="170" cy="190" r="4" class="hotspot" style="animation-delay: 0.5s" />
                            <circle cx="480" cy="130" r="5" class="hotspot" style="animation-delay: 1s" /> <!-- Europe -->
                            <circle cx="650" cy="240" r="4" class="hotspot" style="animation-delay: 1.5s" /> <!-- Aus -->
                            <circle cx="620" cy="150" r="8" class="hotspot" style="animation-delay: 0.2s" /> <!-- India -->
                        </svg>
                        <div class="absolute bottom-4 left-4 bg-white/80 dark:bg-black/80 backdrop-blur px-3 py-1 rounded-md text-[10px] font-bold border border-neutral-200 dark:border-white/10">
                            Interactive View
                        </div>
                    </div>

                    <!-- List Side -->
                    <div class="w-full md:w-1/3 flex flex-col">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-sm font-bold text-neutral-900 dark:text-white">Top Locations</h3>
                            <div class="flex gap-1">
                                <button class="px-2 py-1 text-[10px] font-bold bg-brand-100 dark:bg-brand-900/30 text-brand-700 dark:text-brand-400 rounded">Country</button>
                                <button class="px-2 py-1 text-[10px] font-bold text-neutral-500 hover:bg-neutral-100 dark:hover:bg-white/10 rounded">City</button>
                            </div>
                        </div>
                        
                        <div class="overflow-y-auto custom-scroll pr-2 flex-1 space-y-1 max-h-[250px]">
                            <!-- Row 1 -->
                            <div class="flex items-center justify-between p-2 rounded hover:bg-neutral-50 dark:hover:bg-white/5 transition-colors text-xs group">
                                <div class="flex items-center gap-2">
                                    <span class="font-mono text-neutral-400 w-4">1</span>
                                    <span class="font-bold text-neutral-700 dark:text-neutral-300">United States</span>
                                </div>
                                <div class="flex items-center gap-4">
                                    <span class="font-mono text-neutral-900 dark:text-white">205</span>
                                    <span class="font-mono text-neutral-400 w-8 text-right">54.2%</span>
                                </div>
                            </div>
                            <!-- Row 2 -->
                            <div class="flex items-center justify-between p-2 rounded hover:bg-neutral-50 dark:hover:bg-white/5 transition-colors text-xs group">
                                <div class="flex items-center gap-2">
                                    <span class="font-mono text-neutral-400 w-4">2</span>
                                    <span class="font-bold text-neutral-700 dark:text-neutral-300">India</span>
                                </div>
                                <div class="flex items-center gap-4">
                                    <span class="font-mono text-neutral-900 dark:text-white">180</span>
                                    <span class="font-mono text-neutral-400 w-8 text-right">41.0%</span>
                                </div>
                            </div>
                             <!-- Row 3 -->
                             <div class="flex items-center justify-between p-2 rounded hover:bg-neutral-50 dark:hover:bg-white/5 transition-colors text-xs group">
                                <div class="flex items-center gap-2">
                                    <span class="font-mono text-neutral-400 w-4">3</span>
                                    <span class="font-bold text-neutral-700 dark:text-neutral-300">Germany</span>
                                </div>
                                <div class="flex items-center gap-4">
                                    <span class="font-mono text-neutral-900 dark:text-white">80</span>
                                    <span class="font-mono text-neutral-400 w-8 text-right">21.2%</span>
                                </div>
                            </div>
                             <!-- Row 4 -->
                             <div class="flex items-center justify-between p-2 rounded hover:bg-neutral-50 dark:hover:bg-white/5 transition-colors text-xs group">
                                <div class="flex items-center gap-2">
                                    <span class="font-mono text-neutral-400 w-4">4</span>
                                    <span class="font-bold text-neutral-700 dark:text-neutral-300">United Kingdom</span>
                                </div>
                                <div class="flex items-center gap-4">
                                    <span class="font-mono text-neutral-900 dark:text-white">52</span>
                                    <span class="font-mono text-neutral-400 w-8 text-right">12.5%</span>
                                </div>
                            </div>
                            <!-- Row 5 -->
                            <div class="flex items-center justify-between p-2 rounded hover:bg-neutral-50 dark:hover:bg-white/5 transition-colors text-xs group">
                                <div class="flex items-center gap-2">
                                    <span class="font-mono text-neutral-400 w-4">5</span>
                                    <span class="font-bold text-neutral-700 dark:text-neutral-300">Canada</span>
                                </div>
                                <div class="flex items-center gap-4">
                                    <span class="font-mono text-neutral-900 dark:text-white">12</span>
                                    <span class="font-mono text-neutral-400 w-8 text-right">3.1%</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-3 pt-3 border-t border-neutral-100 dark:border-white/5 flex justify-center gap-2">
                            <button class="w-6 h-6 flex items-center justify-center rounded bg-brand-50 dark:bg-brand-900/20 text-brand-600 text-xs"><i class="fa-solid fa-chevron-left"></i></button>
                            <span class="text-[10px] text-neutral-400 flex items-center">1 / 2</span>
                            <button class="w-6 h-6 flex items-center justify-center rounded hover:bg-neutral-100 dark:hover:bg-white/10 text-neutral-500 text-xs"><i class="fa-solid fa-chevron-right"></i></button>
                        </div>
                    </div>
                </div>

                <!-- 4. REFERRERS (List) - Spans 1 col -->
                <div class="stat-card p-6 gsap-fade-up">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-sm font-bold text-neutral-900 dark:text-white">Top Referrers</h3>
                    </div>
                    <div class="space-y-4">
                        <!-- Ref 1 -->
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded bg-blue-50 dark:bg-blue-900/20 flex items-center justify-center text-blue-600 text-sm"><i class="fa-brands fa-facebook-f"></i></div>
                                <div>
                                    <div class="text-xs font-bold text-neutral-900 dark:text-white">Facebook</div>
                                    <div class="text-[10px] text-neutral-500">Social</div>
                                </div>
                            </div>
                            <div class="text-xs font-mono font-bold text-neutral-900 dark:text-white">112</div>
                        </div>
                        <!-- Ref 2 -->
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded bg-pink-50 dark:bg-pink-900/20 flex items-center justify-center text-pink-600 text-sm"><i class="fa-brands fa-instagram"></i></div>
                                <div>
                                    <div class="text-xs font-bold text-neutral-900 dark:text-white">Instagram</div>
                                    <div class="text-[10px] text-neutral-500">Social</div>
                                </div>
                            </div>
                            <div class="text-xs font-mono font-bold text-neutral-900 dark:text-white">84</div>
                        </div>
                         <!-- Ref 3 -->
                         <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded bg-red-50 dark:bg-red-900/20 flex items-center justify-center text-red-600 text-sm"><i class="fa-brands fa-youtube"></i></div>
                                <div>
                                    <div class="text-xs font-bold text-neutral-900 dark:text-white">YouTube</div>
                                    <div class="text-[10px] text-neutral-500">Video</div>
                                </div>
                            </div>
                            <div class="text-xs font-mono font-bold text-neutral-900 dark:text-white">64</div>
                        </div>
                         <!-- Ref 4 -->
                         <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded bg-neutral-100 dark:bg-white/10 flex items-center justify-center text-neutral-600 text-sm"><i class="fa-solid fa-envelope"></i></div>
                                <div>
                                    <div class="text-xs font-bold text-neutral-900 dark:text-white">Email / Direct</div>
                                    <div class="text-[10px] text-neutral-500">Direct</div>
                                </div>
                            </div>
                            <div class="text-xs font-mono font-bold text-neutral-900 dark:text-white">45</div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <script src="https://unpkg.com/@studio-freight/lenis@1.0.29/dist/lenis.min.js"></script> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            
            // --- DARK MODE ---
            const themeToggleBtn = document.getElementById('theme-toggle');
            try {
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme === 'dark') document.documentElement.classList.add('dark');
            } catch (e) {}

            function toggleTheme(event) {
                const x = event?.clientX ?? innerWidth / 2;
                const y = event?.clientY ?? innerHeight / 2;

                if (!document.startViewTransition) {
                    const isDark = document.documentElement.classList.toggle('dark');
                    localStorage.setItem('theme', isDark ? 'dark' : 'light');
                    updateCharts();
                    return;
                }

                const endRadius = Math.hypot(Math.max(x, innerWidth - x), Math.max(y, innerHeight - y));
                const transition = document.startViewTransition(() => {
                    document.documentElement.classList.toggle('dark');
                    localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
                    updateCharts();
                });

                transition.ready.then(() => {
                    document.documentElement.animate(
                        { clipPath: [`circle(0px at ${x}px ${y}px)`, `circle(${endRadius}px at ${x}px ${y}px)`] },
                        { duration: 600, easing: 'ease-out', pseudoElement: '::view-transition-new(root)' }
                    );
                });
            }
            if(themeToggleBtn) themeToggleBtn.addEventListener('click', toggleTheme);

            // --- SCROLL ---
            const contentDiv = document.getElementById('analytics-content');
            const lenis = new Lenis({ wrapper: contentDiv, content: contentDiv, duration: 1.2, smooth: true });
            function raf(time) { lenis.raf(time * 1000); requestAnimationFrame(raf); }
            requestAnimationFrame(raf);

            // --- ANIMATION ---
            gsap.from(".gsap-fade-up", {
                y: 30, opacity: 0, duration: 0.8, stagger: 0.1, ease: "power3.out", delay: 0.1
            });

            // --- CHARTS ---
            let mainChart, deviceChart;
            
            function initCharts() {
                const isDark = document.documentElement.classList.contains('dark');
                const textColor = isDark ? '#94a3b8' : '#64748b';
                const gridColor = isDark ? 'rgba(255,255,255,0.05)' : 'rgba(0,0,0,0.05)';
                
                // 1. MAIN CHART (Area Line)
                const ctx1 = document.getElementById('mainChart').getContext('2d');
                const gradient = ctx1.createLinearGradient(0, 0, 0, 300);
                gradient.addColorStop(0, 'rgba(16, 185, 129, 0.4)');
                gradient.addColorStop(1, 'rgba(16, 185, 129, 0.0)');

                if(mainChart) mainChart.destroy();
                mainChart = new Chart(ctx1, {
                    type: 'line',
                    data: {
                        labels: ['Nov 17', 'Nov 18', 'Nov 19', 'Nov 20', 'Nov 21', 'Nov 22', 'Nov 23'],
                        datasets: [{
                            label: 'Engagements',
                            data: [12, 19, 35, 25, 45, 30, 55],
                            borderColor: '#10b981',
                            backgroundColor: gradient,
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true,
                            pointRadius: 0,
                            pointHoverRadius: 6,
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: '#10b981'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        scales: {
                            x: { grid: { display: false }, ticks: { color: textColor, font: {family: 'Plus Jakarta Sans', size: 10} } },
                            y: { grid: { color: gridColor, borderDash: [5,5] }, ticks: { color: textColor, font: {family: 'JetBrains Mono', size: 10} }, border: {display: false} }
                        }
                    }
                });

                // 2. DEVICE CHART (Doughnut)
                const ctx2 = document.getElementById('deviceChart').getContext('2d');
                if(deviceChart) deviceChart.destroy();
                deviceChart = new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: ['Desktop', 'Mobile', 'Tablet'],
                        datasets: [{
                            data: [146, 101, 70],
                            backgroundColor: ['#10b981', '#3b82f6', '#2dd4bf'], // Emerald, Blue, Teal
                            borderWidth: 0,
                            hoverOffset: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        cutout: '80%',
                        plugins: { legend: { display: false } }
                    }
                });
            }

            initCharts();

            function updateCharts() {
                setTimeout(initCharts, 50); // Wait for dark mode class update
            }
        });
    </script>
</body>
</html>